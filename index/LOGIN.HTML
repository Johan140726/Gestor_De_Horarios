<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChronosCode Login</title>
    <link rel="stylesheet "  href="../CSS/style.css">
</head>

<body>

    <div class="container">
        <div class="login-box">
            <div id="logo-header">
                <img src="/modelado/assets/Logo.png" style="text-align: center;"  alt="Logo">
            </div>

            <h2>Iniciar Sesi칩n</h2>

            <form id="formLogin">

                <div class="input-box">
                    
                    <input type="email" id="correo" placeholder="correo " required>
                </div>

                <div class="input-box">
                    
                    <input type="password" id="contrase침a" placeholder="contrase침a"   required>
                </div>

                <button class="btn" type="submit">Ingresar</button>
            </form>

            <p class="crear">
                쯅o tienes cuenta?
                <a href="Crear_Usuario1.html">Crear Usuario</a>
            </p>

        </div>
    </div>

    <script>
document.getElementById("formLogin").addEventListener("submit", async function (e) {
    e.preventDefault();

    const datos = {
        correo: document.getElementById("correo").value,
        contrase침a: document.getElementById("contrase침a").value
    };

    try {
        const resp = await fetch("http://localhost:3000/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(datos)
        });

        const data = await resp.json();
        console.log("Respuesta del servidor:", data);

        if (!resp.ok) {
            alert(data.mensaje || "Error en login");
            return;
        }

        // 游댠 Guardar el ID CORRECTAMENTE
        localStorage.setItem("usuarioID", data.id);
        localStorage.setItem("usuarioCargo", data.cargo);
        localStorage.setItem("usuarioNombre", data.nombre);

        // Redirecci칩n seg칰n cargo
        if (data.cargo === "Administrador") {
            window.location.href = "Administrador.html";
        } else if (data.cargo === "Empleado") {
            window.location.href = "Empleado.html";
        } else {
            alert("Cargo no reconocido en el sistema");
        }

    } catch (error) {
        console.error(error);
        alert("No se pudo conectar al servidor");
    }
});
</script>


</body>

</html>